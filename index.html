<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>å¦‚å®çš„æ•°å­¦é—¯å…³ï¼ˆä¸¤ä½/ä¸‰ä½ â‰¤150ï¼‰</title>
<style>
  :root{
    --bg1:#e8f7ff;
    --bg2:#fff;
    --accent:#ffb6c1;
    --card:#fff;
    --btn:#ffcc66;
    --btn-hover:#ff9b2b;
    --ok:#3bc371;
    --bad:#ff6b6b;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: "PingFang SC","Microsoft Yahei","Noto Sans SC",sans-serif;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#222;
    display:flex;
    flex-direction:column;
    min-height:100vh;
    align-items:center;
    padding:12px;
  }
  header{
    width:100%;
    max-width:1000px;
    padding:12px 16px;
    background:linear-gradient(90deg,var(--accent),#ffdede);
    border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.08);
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    margin-bottom:12px;
  }
  header h1{ margin:0; font-size:1.2rem; display:flex; gap:8px; align-items:center;}
  header .meta{ font-size:0.95rem; color:#333; opacity:0.95;}

  .game{
    width:100%;
    max-width:1000px;
    display:grid;
    grid-template-columns: 1fr 320px;
    gap:14px;
  }
  /* ä¸»é¢æ¿ */
  .panel{
    background:var(--card);
    border-radius:12px;
    padding:14px;
    box-shadow:0 8px 24px rgba(0,0,0,0.06);
  }
  .left{ min-height:520px; display:flex; flex-direction:column; align-items:center; gap:12px; }
  .right{ min-height:520px; }

  /* é¡¶éƒ¨å…³å¡/è¿›åº¦æ¡ */
  .top-info{
    width:100%;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
  }
  .level { font-weight:700; font-size:1.05rem; }
  .progress {
    font-size:0.95rem;
    color:#444;
  }

  /* çŒ«å’ªæ˜¾ç¤ºåŒº */
  .cat-area{
    width:100%;
    max-width:560px;
    height:260px;
    background:linear-gradient(180deg,#fff8f2,#fff);
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    overflow:visible;
  }

  /* GIF çŒ«å’ªæ ·å¼ */
  .cat-gif{ width:220px; height:auto; transition:transform .18s ease, opacity .2s ease; border-radius:12px; }
  .hidden{ display:none !important; opacity:0; }

  /* å¼€å¿ƒä¹±çªœï¼šå¿«é€Ÿå·¦å³æ‘†åŠ¨ï¼ˆä½œç”¨åœ¨å®¹å™¨è€Œä¸æ˜¯GIFæœ¬èº«ä¹Ÿå¯ï¼‰ */
  .crazy { animation: crazyMove 0.55s ease-in-out infinite; }
  @keyframes crazyMove {
    0%{ transform: translateX(-20px) rotate(-6deg) scale(1.02) }
    50%{ transform: translateX(20px) rotate(6deg) scale(1.06) }
    100%{ transform: translateX(-20px) rotate(-6deg) scale(1.02) }
  }

  /* æ²®ä¸§ï¼šè½»å¾®ä¸‹æ²‰ + ç°åŒ– */
  .sad { animation: sadBreathe 1s ease-in-out; filter:grayscale(.1) contrast(.95); }
  @keyframes sadBreathe { 0%{transform:translateY(0)} 50%{transform:translateY(6px) scale(.995)} 100%{transform:translateY(0)} }

  /* é±¼å¹²æ‰è½ */
  .fish{
    position:absolute;
    top:6px;
    font-size:1.9rem;
    animation: fishFall .9s cubic-bezier(.2,.9,.2,1);
    pointer-events:none;
  }
  @keyframes fishFall { 0%{transform:translateY(-6px) scale(.95) rotate(-6deg);opacity:1} 70%{transform:translateY(130px) scale(1.02) rotate(10deg);opacity:1} 100%{transform:translateY(180px) scale(.9) rotate(10deg);opacity:0} }

  /* é¢˜ç›®ä¸é€‰é¡¹ */
  .question {
    font-size:1.6rem;
    font-weight:800;
    background:linear-gradient(90deg,#fff,#fff8e6);
    padding:10px 14px;
    border-radius:10px;
    box-shadow:0 6px 16px rgba(0,0,0,.04);
    min-width:260px;
    text-align:center;
  }
  .options {
    width:100%;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
    margin-top:6px;
  }
  .options button{
    min-width:110px;
    padding:10px 12px;
    font-size:1.05rem;
    background:var(--btn);
    border-radius:10px;
    border:0;
    cursor:pointer;
    box-shadow:0 6px 0 rgba(0,0,0,0.06);
  }
  .options button:hover{ background:var(--btn-hover); color:#fff; }

  .input-mode{ display:flex; gap:10px; justify-content:center; align-items:center; margin-top:6px; }
  input[type="number"]{
    font-size:1.05rem; padding:8px 12px; border-radius:8px; border:1px solid #ddd; width:140px; text-align:center;
  }
  .controls-row { display:flex; gap:10px; align-items:center; justify-content:center; margin-top:8px; flex-wrap:wrap; }

  /* å³ä¾§ç«–å¼å¡ç‰‡ä¸è®¾ç½® */
  .right .panel-inner{ display:flex; flex-direction:column; gap:12px; }
  .vcard{ padding:12px; border-radius:10px; background:linear-gradient(180deg,#fff,#fff8f7); box-shadow:0 6px 12px rgba(0,0,0,0.04); min-height:120px; }
  pre.vcols{
    font-family: "Courier New",monospace;
    font-size:1.05rem;
    margin:0;
    padding:6px;
    background:rgba(0,0,0,0.03);
    border-radius:6px;
    white-space:pre;
    text-align:right;
  }
  .switch {
    padding:8px 12px; border-radius:8px; background:#fff; border:1px solid #eee; cursor:pointer;
  }
  .small{ font-size:0.95rem; color:#555; }

  /* å…³å¡æç¤º */
  .badge{ padding:8px 10px; border-radius:8px; background:linear-gradient(90deg,#fff,#fff8e6); box-shadow:0 4px 10px rgba(0,0,0,0.04); }

  footer{ width:100%; max-width:1000px; margin-top:12px; text-align:center; color:#666; font-size:0.95rem; }

  /* å¥–åŠ±ç³»ç»ŸåŠ¨ç”» */
  @keyframes rewardSlide {
    0% { transform: translateX(100%); opacity: 0; }
    20% { transform: translateX(0); opacity: 1; }
    80% { transform: translateX(0); opacity: 1; }
    100% { transform: translateX(100%); opacity: 0; }
  }

  @keyframes upgradePulse {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
    50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
  }

  @keyframes confettiFall {
    0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @keyframes celebrationBounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-30px); }
    60% { transform: translateY(-15px); }
  }

  @keyframes celebrationSpin {
    0% { transform: rotate(0deg) scale(0.5); }
    50% { transform: rotate(180deg) scale(1.2); }
    100% { transform: rotate(360deg) scale(1); }
  }

  /* å¥–åŠ±æ˜¾ç¤ºåŒºåŸŸ */
  .reward-display {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    margin: 8px 0;
  }

  /* é…è‰²æ–¹æ¡ˆ */
  :root {
    --primary-color: #ff6b6b;
    --secondary-color: #4ecdc4;
    --accent-color: #45b7d1;
    --success-color: #96ceb4;
    --warning-color: #feca57;
  }

  /* å…³å¡é…è‰²å˜åŒ– */
  .level-1 { --primary-color: #ff6b6b; --secondary-color: #4ecdc4; }
  .level-2 { --primary-color: #a8e6cf; --secondary-color: #ffd3a5; }
  .level-3 { --primary-color: #ffd3a5; --secondary-color: #fd9853; }
  .level-4 { --primary-color: #fd9853; --secondary-color: #a8e6cf; }
  .level-5 { --primary-color: #4ecdc4; --secondary-color: #45b7d1; }
  .level-6 { --primary-color: #45b7d1; --secondary-color: #96ceb4; }
  .level-7 { --primary-color: #96ceb4; --secondary-color: #feca57; }
  .level-8 { --primary-color: #feca57; --secondary-color: #ff6b6b; }
  .level-9 { --primary-color: #ff9a9e; --secondary-color: #fecfef; }
  .level-10 { --primary-color: #fecfef; --secondary-color: #a8e6cf; }

  /* ç«‹ä½“å¯çˆ±é£æ ¼å¢å¼º */
  .vcard {
    background: linear-gradient(145deg, #ffffff, #f0f0f0);
    border-radius: 20px;
    box-shadow: 
      8px 8px 16px rgba(0,0,0,0.1),
      -8px -8px 16px rgba(255,255,255,0.7);
    border: 2px solid rgba(255,255,255,0.3);
    transition: all 0.3s ease;
  }

  .vcard:hover {
    transform: translateY(-2px);
    box-shadow: 
      12px 12px 24px rgba(0,0,0,0.15),
      -12px -12px 24px rgba(255,255,255,0.8);
  }

  .switch {
    background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
    border: none;
    border-radius: 25px;
    box-shadow: 
      6px 6px 12px rgba(0,0,0,0.2),
      -6px -6px 12px rgba(255,255,255,0.3);
    transition: all 0.3s ease;
  }

  .switch:hover {
    transform: translateY(-1px);
    box-shadow: 
      8px 8px 16px rgba(0,0,0,0.25),
      -8px -8px 16px rgba(255,255,255,0.4);
  }

  .switch:active {
    transform: translateY(1px);
    box-shadow: 
      4px 4px 8px rgba(0,0,0,0.2),
      -4px -4px 8px rgba(255,255,255,0.3);
  }

  /* ç­”æ¡ˆæŒ‰é’®ç«‹ä½“æ•ˆæœ */
  .answer-btn {
    background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
    border: none;
    border-radius: 20px;
    box-shadow: 
      6px 6px 12px rgba(0,0,0,0.2),
      -6px -6px 12px rgba(255,255,255,0.3);
    transition: all 0.3s ease;
  }

  .answer-btn:hover {
    transform: translateY(-2px);
    box-shadow: 
      8px 8px 16px rgba(0,0,0,0.25),
      -8px -8px 16px rgba(255,255,255,0.4);
  }

  .answer-btn:active {
    transform: translateY(1px);
    box-shadow: 
      4px 4px 8px rgba(0,0,0,0.2),
      -4px -4px 8px rgba(255,255,255,0.3);
  }

  /* é¡¶éƒ¨æ¨ªæ ç«‹ä½“æ•ˆæœ */
  header {
    background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
    box-shadow: 
      0 8px 16px rgba(0,0,0,0.1),
      inset 0 1px 0 rgba(255,255,255,0.3);
    border-bottom: 3px solid rgba(255,255,255,0.2);
  }

  /* éšè—å¥–åŠ±æ•ˆæœ */
  
  /* æ³¡æ³¡æ•ˆæœ */
  .bubble {
    position: absolute;
    width: 40px;
    height: 40px;
    background: radial-gradient(circle, rgba(173, 216, 230, 0.6), rgba(135, 206, 250, 0.2));
    border-radius: 50%;
    pointer-events: none;
    animation: bubbleFloat 3s ease-in-out infinite;
    border: 2px solid rgba(135, 206, 250, 0.4);
  }
  
  @keyframes bubbleFloat {
    0% { 
      transform: translateY(0) scale(0.8);
      opacity: 0.8;
    }
    50% { 
      transform: translateY(-30px) scale(1.2);
      opacity: 1;
    }
    100% { 
      transform: translateY(-60px) scale(0.6);
      opacity: 0;
    }
  }
  
  /* å°è€é¼ ç©å…·æ•ˆæœ */
  .mouse-toy {
    position: absolute;
    font-size: 32px;
    pointer-events: none;
    animation: mouseMove 4s ease-in-out infinite;
  }
  
  @keyframes mouseMove {
    0% { transform: translateX(0) translateY(0) rotate(0deg); }
    25% { transform: translateX(50px) translateY(-20px) rotate(10deg); }
    50% { transform: translateX(100px) translateY(0) rotate(-5deg); }
    75% { transform: translateX(50px) translateY(20px) rotate(8deg); }
    100% { transform: translateX(0) translateY(0) rotate(0deg); }
  }
  
  /* æ’¸çŒ«æ•ˆæœ */
  .petting-hand {
    position: absolute;
    font-size: 120px;
    pointer-events: none;
    animation: pettingMove 2s ease-in-out infinite;
  }
  
  /* ä¿®å‰ªçŒ«æ¯›æ•ˆæœ */
  .scissors {
    position: absolute;
    font-size: 40px;
    pointer-events: none;
    animation: scissorsCut 1.5s ease-in-out infinite;
  }
  
  @keyframes scissorsCut {
    0% { transform: translateX(0) translateY(0) rotate(0deg); }
    25% { transform: translateX(10px) translateY(-5px) rotate(15deg); }
    50% { transform: translateX(20px) translateY(0) rotate(-10deg); }
    75% { transform: translateX(10px) translateY(5px) rotate(20deg); }
    100% { transform: translateX(0) translateY(0) rotate(0deg); }
  }
  
  /* çŒ«æ¯›æ‰è½æ•ˆæœ */
  .cat-hair {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #8b4513;
    border-radius: 50%;
    pointer-events: none;
    animation: hairFall 2s ease-out forwards;
  }
  
  @keyframes hairFall {
    0% { 
      transform: translateY(0) rotate(0deg); 
      opacity: 1; 
    }
    100% { 
      transform: translateY(80px) rotate(360deg); 
      opacity: 0; 
    }
  }
  
  /* ä¸»äººæŠ±æŠ±æ•ˆæœ */
  .hug-hands {
    position: absolute;
    font-size: 60px;
    pointer-events: none;
    animation: hugMove 3s ease-in-out infinite;
  }
  
  @keyframes hugMove {
    0% { transform: translateX(0) translateY(0) scale(1); }
    25% { transform: translateX(-20px) translateY(-10px) scale(1.1); }
    50% { transform: translateX(0) translateY(0) scale(1.2); }
    75% { transform: translateX(20px) translateY(-10px) scale(1.1); }
    100% { transform: translateX(0) translateY(0) scale(1); }
  }
  
  @keyframes pettingMove {
    0% { transform: translateX(0) translateY(0) rotate(0deg); }
    25% { transform: translateX(30px) translateY(-10px) rotate(15deg); }
    50% { transform: translateX(60px) translateY(0) rotate(-10deg); }
    75% { transform: translateX(30px) translateY(10px) rotate(20deg); }
    100% { transform: translateX(0) translateY(0) rotate(0deg); }
  }
  
  /* å¥–åŠ±è§£é”æç¤º */
  .unlock-notification {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
    color: white;
    padding: 20px 30px;
    border-radius: 15px;
    font-size: 18px;
    font-weight: bold;
    z-index: 1000;
    animation: unlockPulse 3s ease-out forwards;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }
  
  @keyframes unlockPulse {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
    20% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
    80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
  }
  
  /* åŠ¨æ€æç¤ºæ–‡å­—æ•ˆæœ */
  .effect-speech {
    position: absolute;
    font-family: "PingFang SC", "Microsoft Yahei", "Noto Sans SC", sans-serif;
    font-size: 16px;
    font-weight: bold;
    color: #333;
    background: linear-gradient(45deg, #fff, #f0f8ff);
    padding: 8px 16px;
    border-radius: 20px;
    border: 2px solid #87ceeb;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    pointer-events: none;
    z-index: 15;
    white-space: nowrap;
    animation: speechBubble 3s ease-out forwards;
  }
  
  @keyframes speechBubble {
    0% { 
      transform: translateY(0) scale(0.8); 
      opacity: 0; 
    }
    15% { 
      transform: translateY(-10px) scale(1.1); 
      opacity: 1; 
    }
    85% { 
      transform: translateY(-10px) scale(1); 
      opacity: 1; 
    }
    100% { 
      transform: translateY(-20px) scale(0.9); 
      opacity: 0; 
    }
  }
  
  /* æ³¡æ³¡æ•ˆæœä¸“ç”¨æç¤º */
  .bubble-speech {
    color: #1e90ff;
    background: linear-gradient(45deg, #e6f3ff, #b3d9ff);
    border-color: #87ceeb;
  }
  
  /* å°è€é¼ æ•ˆæœä¸“ç”¨æç¤º */
  .mouse-speech {
    color: #8b4513;
    background: linear-gradient(45deg, #fff8dc, #f5deb3);
    border-color: #daa520;
  }
  
  /* æ’¸çŒ«æ•ˆæœä¸“ç”¨æç¤º */
  .petting-speech {
    color: #ff69b4;
    background: linear-gradient(45deg, #ffe4e1, #ffb6c1);
    border-color: #ff69b4;
  }
  
  /* ä¿®å‰ªçŒ«æ¯›æ•ˆæœä¸“ç”¨æç¤º */
  .scissors-speech {
    color: #ff4500;
    background: linear-gradient(45deg, #fff5ee, #ffd700);
    border-color: #ff8c00;
  }
  
  /* ä¸»äººæŠ±æŠ±æ•ˆæœä¸“ç”¨æç¤º */
  .hug-speech {
    color: #8b008b;
    background: linear-gradient(45deg, #f0e6ff, #dda0dd);
    border-color: #9370db;
  }

  /* å€’è®¡æ—¶æ ·å¼ */
  .timer {
    position: absolute;
    top: 10px;
    right: 10px;
    background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 18px;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    z-index: 20;
    animation: timerPulse 1s ease-in-out infinite;
  }
  
  @keyframes timerPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  
  .timer.warning {
    background: linear-gradient(45deg, #ff4757, #ff3838);
    animation: timerWarning 0.5s ease-in-out infinite;
  }
  
  @keyframes timerWarning {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  
  /* ç®¡ç†å‘˜è®¾ç½®é¢æ¿ */
  .admin-panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(145deg, #2c3e50, #34495e);
    color: white;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    z-index: 10000;
    display: none;
    min-width: 400px;
  }
  
  .admin-panel h3 {
    margin: 0 0 20px 0;
    text-align: center;
    color: #ecf0f1;
  }
  
  .admin-panel label {
    display: block;
    margin: 15px 0 5px 0;
    font-weight: bold;
  }
  
  .admin-panel input {
    width: 100%;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    margin-bottom: 10px;
  }
  
  .admin-panel button {
    background: linear-gradient(45deg, #3498db, #2980b9);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin: 5px;
    font-size: 14px;
  }
  
  .admin-panel button:hover {
    background: linear-gradient(45deg, #2980b9, #1f618d);
  }
  
  .admin-panel .close-btn {
    background: linear-gradient(45deg, #e74c3c, #c0392b);
  }
  
  .admin-panel .close-btn:hover {
    background: linear-gradient(45deg, #c0392b, #a93226);
  }
  
  /* ç®¡ç†å‘˜é’¥åŒ™æŒ‰é’® */
  .admin-key-btn {
    position: absolute;
    top: 50%;
    right: 20px;
    transform: translateY(-50%);
    background: linear-gradient(45deg, #ffd700, #ffed4e);
    border: 2px solid #ff8c00;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
    transition: all 0.3s ease;
    z-index: 1000;
  }
  
  .admin-key-btn:hover {
    background: linear-gradient(45deg, #ffed4e, #ffd700);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 6px 16px rgba(255, 215, 0, 0.5);
  }
  
  .admin-key-btn:active {
    transform: translateY(-50%) scale(0.95);
  }
  
  /* éšè—ç®¡ç†å‘˜æŒ‰é’®ï¼ˆä¿ç•™ä½œä¸ºå¤‡ç”¨ï¼‰ */
  .admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 20px;
    height: 20px;
    background: transparent;
    border: none;
    cursor: pointer;
    z-index: 1000;
    display: none; /* éšè—å¤‡ç”¨æŒ‰é’® */
  }

  /* å“åº”å¼ */
  @media (max-width:920px){
    .game{ grid-template-columns: 1fr; }
    .right{ order:2; }
    .left{ order:1; }
  }
</style>
</head>
<body>
  <header>
    <h1>ğŸ± å¦‚å®çš„æ•°å­¦é—¯å…³</h1>
    <div class="meta">
      <span class="level">ç¬¬ <strong id="levelLabel">1</strong> å…³</span>
      &nbsp;Â·&nbsp;
      <span class="progress">é¢˜ <span id="qIdx">0</span>/10ã€€Â·ã€€ğŸ¥– <strong id="catSticks">0</strong>ã€€ğŸŸ <strong id="fish">0</strong>ã€€ğŸ¥« <strong id="cans">0</strong></span>
    </div>
    <button class="admin-key-btn" id="adminKeyBtn" title="ç®¡ç†å‘˜è®¾ç½®">ğŸ”‘</button>
  </header>

  <div class="game">
    <!-- å·¦ä¾§ä¸»åŒº -->
    <div class="panel left">
      <div class="top-info" style="width:100%">
        <div class="badge">æ¯å…³ 10 é¢˜ï¼Œç­”å¯¹ â‰¥8 å¯è¿‡å…³</div>
        <div class="badge small">å¯åˆ‡æ¢é€‰æ‹©é¢˜ / å¡«ç©ºé¢˜ Â· å¯æ˜¾ç¤ºç«–å¼</div>
      </div>

      <div class="cat-area" id="catArea" aria-hidden="false">
        <!-- å€’è®¡æ—¶æ˜¾ç¤º -->
        <div class="timer" id="timer" style="display: none;">10</div>
        <!-- GIF çŒ«å’ªï¼šç­‰å¾… / å¼€å¿ƒ / ä¼¤å¿ƒï¼ˆä½¿ç”¨ Base64 å ä½ç¬¦ï¼‰ -->
        <!-- ä¿®æ”¹ä¸ºGitHubè·¯å¾„å¼•ç”¨ -->
        <img id="cat-wait" class="cat-gif" alt="å¦‚å®ç­‰å¾…" src="images/cat-wait.gif" />
        <img id="cat-crazy" class="cat-gif hidden" alt="å¦‚å®å¼€å¿ƒ" src="images/cat-crazy.gif" />
        <img id="cat-sad" class="cat-gif hidden" alt="å¦‚å®éš¾è¿‡" src="images/cat-sad.gif" />
        <!-- é±¼å¹²å®¹å™¨ -->
        <div id="fishDropArea" style="position:absolute; inset:0; pointer-events:none;"></div>
      </div>

      <div class="question panel" id="question">é¢˜ç›®åŠ è½½ä¸­...</div>

      <!-- é€‰æ‹©é¢˜åŒºåŸŸï¼ˆ5 ä¸ªé€‰é¡¹ï¼‰ -->
      <div class="options panel" id="optionsBox" style="min-height:120px; display:flex;flex-direction:column;align-items:center;justify-content:center;">
        <div class="options-row options" id="optionsRow"></div>
      </div>

      <!-- å¡«ç©ºæ¨¡å¼ -->
      <div class="panel input-mode" id="fillBox" style="display:none; align-items:center; justify-content:center;">
        <input id="answerInput" type="number" placeholder="è¯·è¾“å…¥ç­”æ¡ˆ" aria-label="è¾“å…¥ç­”æ¡ˆ"/>
        <button id="submitFill" class="switch">æäº¤</button>
      </div>

      <div class="controls-row" style="margin-top:6px;">
        <button id="modeToggle" class="switch">åˆ‡æ¢åˆ° å¡«ç©ºé¢˜æ¨¡å¼</button>
        <button id="showVertBtn" class="switch">éšè—ç«–å¼</button>
        <button id="soundToggle" class="switch" aria-pressed="true">éŸ³æ•ˆï¼šå¼€</button>
        <button id="resetBtn" class="switch">é‡ç½®å…³å¡ä¸åˆ†æ•°</button>
      </div>
    </div>

    <!-- å³ä¾§ï¼šç«–å¼é¢æ¿ & è®¾ç½® -->
    <div class="panel right">
      <div class="panel-inner">
        <div class="vcard">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <div><strong id="hintTitle">ç«–å¼æç¤º</strong></div>
            <div class="small">ï¼ˆåªå±•ç¤ºæ’åˆ—ï¼Œä¸ç»™ç»“æœï¼‰</div>
          </div>
          <pre class="vcols" id="verticalArea">ç«–å¼å·²æ˜¾ç¤ºï¼Œç‚¹å‡»"éšè—ç«–å¼"å¯éšè—</pre>
        </div>

        <div class="vcard">
          <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;">
            <div>
              <div class="small">å½“å‰è¿›åº¦</div>
              <div style="font-weight:700; font-size:1.05rem;">ç¬¬ <span id="levelNumber">1</span> å…³ Â· ç¬¬ <span id="qNumber">1</span> é¢˜ / 10</div>
            </div>
            <div style="text-align:right;">
              <div class="small">æœ¬å…³ç­”å¯¹</div>
              <div style="font-weight:800; font-size:1.35rem;" id="correctThis">0</div>
            </div>
          </div>
        </div>

        <div class="vcard" style="display:flex;flex-direction:column;gap:8px;">
          <div style="display:flex;gap:8px;align-items:center;">
            <div style="font-weight:700;">å¥–åŠ±ç³»ç»Ÿ</div>
          </div>
          <div id="rewardDisplay" class="reward-display">
            <div style="display: flex; gap: 15px; align-items: center; font-size: 14px;">
              <span>ğŸ¥– 0</span>
              <span>ğŸŸ 0</span>
              <span>ğŸ¥« 0</span>
            </div>
          </div>
          <div class="small">ç­”å¯¹1é¢˜è·å¾—1ä¸ªçŒ«æ¡ï¼Œ10ä¸ªçŒ«æ¡æ¢1ä¸ªé±¼å¹²ï¼Œ10ä¸ªé±¼å¹²æ¢1ä¸ªç½å¤´ï¼</div>
        </div>

        <div class="vcard" style="display:flex;flex-direction:column;gap:8px;">
          <div style="display:flex;gap:8px;align-items:center;">
            <div style="font-weight:700;">è¯´æ˜</div>
          </div>
          <div class="small">è§„åˆ™ï¼šæ¯å…³ 10 é¢˜ï¼Œç­”å¯¹ 8 é¢˜æˆ–ä»¥ä¸Šæ‰èƒ½æ™‹çº§ä¸‹ä¸€å…³ã€‚é¢˜ç›®ä¸ç­”æ¡ˆä¸è¶…è¿‡ <strong>150</strong>ã€‚å¯åœ¨å³ä¾§æŸ¥çœ‹ç«–å¼å¸®åŠ©ï¼ˆä¸æ˜¾ç¤ºç­”æ¡ˆï¼‰ã€‚</div>
        </div>
      </div>
    </div>
  </div>

  <footer>å¿«ä¹æ¸¸æˆï¼Œå¿«ä¹å­¦ä¹ ï¼Œå¿«ä¹æ’¸çŒ«ã€‚</footer>
  
  <!-- éšè—ç®¡ç†å‘˜æŒ‰é’® -->
  <button class="admin-trigger" id="adminTrigger" title="ç®¡ç†å‘˜è®¾ç½®"></button>
  
  <!-- ç®¡ç†å‘˜è®¾ç½®é¢æ¿ -->
  <div class="admin-panel" id="adminPanel">
    <h3>ğŸ”§ ç®¡ç†å‘˜è®¾ç½®</h3>
    <label for="maxValue">æœ€å¤§æ•°å€¼è®¾ç½®ï¼š</label>
    <input type="number" id="maxValue" value="150" min="50" max="1000">
    
    <label for="timerValue">ç­”é¢˜è®¡æ—¶ï¼ˆç§’ï¼‰ï¼š</label>
    <input type="number" id="timerValue" value="20" min="5" max="60">
    
    <div style="text-align: center; margin-top: 20px;">
      <button id="saveSettings">ä¿å­˜è®¾ç½®</button>
      <button class="close-btn" id="closeAdmin">å…³é—­</button>
    </div>
  </div>

<script>
/* ------------------------
   æ¸¸æˆé€»è¾‘å®ç°
-------------------------*/
(() => {
  // DOM
  const qEl = document.getElementById('question');
  const optionsRow = document.getElementById('optionsRow');
  const optionsBox = document.getElementById('optionsBox');
  const fillBox = document.getElementById('fillBox');
  const answerInput = document.getElementById('answerInput');
  const submitFill = document.getElementById('submitFill');
  const modeToggle = document.getElementById('modeToggle');
  const showVertBtn = document.getElementById('showVertBtn');
  const verticalArea = document.getElementById('verticalArea');
  const fishDropArea = document.getElementById('fishDropArea');
  const catWait = document.getElementById('cat-wait');
  const catCrazy = document.getElementById('cat-crazy');
  const catSad = document.getElementById('cat-sad');
  const levelLabel = document.getElementById('levelLabel');
  const levelNumber = document.getElementById('levelNumber');
  const qIdx = document.getElementById('qIdx');
  const qNumber = document.getElementById('qNumber');
  const correctThis = document.getElementById('correctThis');
  const scoreEl = document.getElementById('score');
  const correctThreshold = 8; // pass threshold
  const perLevelCount = 10; // questions per level
  const resetBtn = document.getElementById('resetBtn');
  const modeLabelEl = document.getElementById('modeToggle');

  // è®©é‡æ’­é€»è¾‘æœ‰åŸºå‡† srcï¼ˆåŸºäº Base64ï¼‰
  [catWait, catCrazy, catSad].forEach(el => {
    if (el && !el.getAttribute('data-src')) {
      el.setAttribute('data-src', el.src);
    }
  });

  // æ¸¸æˆçŠ¶æ€ï¼ˆä¿å­˜åœ¨ localStorageï¼‰
  let game = {
    level: parseInt(localStorage.getItem('ruba_level')||'1',10),
    score: parseInt(localStorage.getItem('ruba_score')||'0',10),
    // per-level progress
    qIndex: parseInt(localStorage.getItem('ruba_qIndex')||'0',10), // 0..9
    correctInLevel: parseInt(localStorage.getItem('ruba_correct')||'0',10),
    // æ–°å¢å¥–åŠ±ç³»ç»Ÿ
    catSticks: parseInt(localStorage.getItem('ruba_catSticks')||'0',10), // çŒ«æ¡
    fish: parseInt(localStorage.getItem('ruba_fish')||'0',10), // é±¼å¹²
    cans: parseInt(localStorage.getItem('ruba_cans')||'0',10), // ç½å¤´
    // éšè—å¥–åŠ±è§£é”çŠ¶æ€
    unlockedBubbles: localStorage.getItem('ruba_unlockedBubbles') === 'true',
    unlockedMice: localStorage.getItem('ruba_unlockedMice') === 'true',
    unlockedPetting: localStorage.getItem('ruba_unlockedPetting') === 'true',
    unlockedScissors: localStorage.getItem('ruba_unlockedScissors') === 'true',
    unlockedHug: localStorage.getItem('ruba_unlockedHug') === 'true',
  };

  // UI åˆå§‹æ˜¾ç¤º
  levelLabel.textContent = game.level;
  levelNumber.textContent = game.level;
  if(scoreEl) scoreEl.textContent = game.score;
  qIdx.textContent = game.qIndex;
  qNumber.textContent = game.qIndex + 1;
  correctThis.textContent = game.correctInLevel;
  
  // æ›´æ–°å¥–åŠ±æ˜¾ç¤º
  updateRewardDisplay();
  
  // åº”ç”¨å…³å¡é…è‰²
  applyLevelColors();
  
  // æ£€æŸ¥éšè—å¥–åŠ±è§£é”çŠ¶æ€
  checkHiddenRewards();

  // æ¨¡å¼ choose / fill
  let mode = 'choose';

  // å½“å‰é¢˜ç›®å¯¹è±¡
  let currentQ = null;
  
  // éšè—å¥–åŠ±è½®æ¢è®¡æ•°å™¨ï¼ˆç”¨äºæµ‹è¯•ï¼‰
  let rewardCounter = 0;
  
  // æ¸¸æˆè®¾ç½®
  let gameSettings = {
    maxValue: parseInt(localStorage.getItem('ruba_maxValue') || '150', 10),
    timerValue: parseInt(localStorage.getItem('ruba_timerValue') || '20', 10)
  };
  
  // å€’è®¡æ—¶ç›¸å…³
  let timer = null;
  let timeLeft = gameSettings.timerValue;
  let timerElement = document.getElementById('timer');

  // å·¥å…·ï¼šéšæœºæ•´æ•°
  function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

  // ç”Ÿæˆé¢˜ç›®ï¼Œç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ª2ä½æ•°æˆ–3ä½æ•°
  function genQuestion(){
    const op = Math.random() > 0.5 ? '+' : '-';
    let a, b, ans;
    const maxVal = gameSettings.maxValue;
    
    if(op === '+'){
      // ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ª2ä½æ•°æˆ–3ä½æ•°
      if(Math.random() > 0.5) {
        // aæ˜¯2ä½æ•°æˆ–3ä½æ•°
        a = randInt(10, maxVal - 10);
        const bMax = Math.max(10, Math.min(maxVal - 10, maxVal - a));
        b = randInt(10, bMax);
      } else {
        // bæ˜¯2ä½æ•°æˆ–3ä½æ•°
        b = randInt(10, maxVal - 10);
        const aMax = Math.max(10, Math.min(maxVal - 10, maxVal - b));
        a = randInt(10, aMax);
      }
      ans = a + b;
      if(ans > maxVal){
        b = Math.max(10, maxVal - a);
        ans = a + b;
      }
    } else {
      // å‡æ³•ï¼šç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ª2ä½æ•°æˆ–3ä½æ•°
      if(Math.random() > 0.5) {
        // aæ˜¯2ä½æ•°æˆ–3ä½æ•°
        a = randInt(20, maxVal);
        b = randInt(10, Math.min(a, maxVal));
      } else {
        // bæ˜¯2ä½æ•°æˆ–3ä½æ•°
        b = randInt(10, maxVal);
        a = randInt(b + 10, Math.min(maxVal, b + maxVal));
      }
      ans = a - b;
    }
    return { num1: a, num2: b, operator: op, answer: ans };
  }

  // ç”Ÿæˆ 10 ä¸ªé€‰é¡¹ï¼šæ­£ç¡® + 9 ä¸ªå¹²æ‰°
  function genOptions(correct){
    const set = new Set([correct]);
    const maxVal = gameSettings.maxValue;
    
    // ç”Ÿæˆä¸åŒç±»å‹çš„å¹²æ‰°é€‰é¡¹
    while(set.size < 10){
      let cand;
      const rand = Math.random();
      
      if(rand < 0.3) {
        // 30%æ¦‚ç‡ï¼šæ¥è¿‘æ­£ç¡®ç­”æ¡ˆçš„é€‰é¡¹
        const delta = randInt(-10, 10);
        cand = correct + delta;
      } else if(rand < 0.5) {
        // 20%æ¦‚ç‡ï¼šä¸ªä½æ•°å·®å¼‚
        const delta = randInt(-5, 5);
        cand = correct + delta;
      } else if(rand < 0.7) {
        // 20%æ¦‚ç‡ï¼šåä½æ•°å·®å¼‚
        const delta = randInt(-50, 50);
        cand = correct + delta;
      } else if(rand < 0.85) {
        // 15%æ¦‚ç‡ï¼šå®Œå…¨éšæœº
        cand = randInt(0, maxVal);
      } else {
        // 15%æ¦‚ç‡ï¼šå¸¸è§é”™è¯¯ç­”æ¡ˆï¼ˆå¦‚ä¸ªä½æ•°ç›¸åŠ ã€åä½æ•°ç›¸åŠ ç­‰ï¼‰
        const tens = Math.floor(correct / 10) * 10;
        const ones = correct % 10;
        cand = tens + randInt(-20, 20);
      }
      
      if(cand >= 0 && cand <= maxVal) set.add(cand);
    }
    
    const arr = Array.from(set);
    // éšæœºæ‰“ä¹±é€‰é¡¹é¡ºåº
    for(let i=arr.length-1;i>0;i--){ 
      const j = Math.floor(Math.random()*(i+1)); 
      [arr[i],arr[j]]=[arr[j],arr[i]]; 
    }
    return arr;
  }

  // å€’è®¡æ—¶åŠŸèƒ½
  function startTimer(){
    timeLeft = gameSettings.timerValue;
    timerElement.style.display = 'block';
    timerElement.textContent = timeLeft;
    timerElement.classList.remove('warning');
    
    timer = setInterval(() => {
      timeLeft--;
      timerElement.textContent = timeLeft;
      
      if(timeLeft <= 3) {
        timerElement.classList.add('warning');
      }
      
      if(timeLeft <= 0) {
        clearInterval(timer);
        timerElement.style.display = 'none';
        // æ—¶é—´åˆ°ï¼Œè‡ªåŠ¨ç­”é”™
        handleAnswer(-999); // ç”¨ä¸€ä¸ªä¸å¯èƒ½çš„å€¼è¡¨ç¤ºè¶…æ—¶
      }
    }, 1000);
  }
  
  function stopTimer(){
    if(timer) {
      clearInterval(timer);
      timer = null;
    }
    timerElement.style.display = 'none';
  }

  // æ˜¾ç¤ºé¢˜ç›®ä¸é€‰é¡¹/å¡«ç©º
  function renderQuestion(){
    currentQ = genQuestion();
    qEl.textContent = `${currentQ.num1} ${currentQ.operator} ${currentQ.num2} = ?`;
    setCatState('wait');
    if(mode === 'choose'){
      optionsBox.style.display = 'flex';
      fillBox.style.display = 'none';
      renderOptions();
    } else {
      optionsBox.style.display = 'none';
      fillBox.style.display = 'flex';
      answerInput.value = '';
      answerInput.focus();
    }
    renderVertical(currentQ);
    qIdx.textContent = game.qIndex;
    qNumber.textContent = game.qIndex + 1;
    
    // å¼€å§‹å€’è®¡æ—¶
    startTimer();
  }

  function renderOptions(){
    optionsRow.innerHTML = '';
    const arr = genOptions(currentQ.answer);
    arr.forEach(val => {
      const btn = document.createElement('button');
      btn.textContent = val;
      btn.addEventListener('click', ()=> { handleAnswer(val); });
      optionsRow.appendChild(btn);
    });
  }

  // åˆ‡æ¢çŒ«å’ªçŠ¶æ€å¹¶é‡æ’­ GIF
  function restartGif(img){
    const base = img.getAttribute('data-src') || img.src;
    if(!base) return;
    img.setAttribute('data-src', base.split('#')[0]);
    const bust = (img.getAttribute('data-src')||'') + '#' + Date.now();
    img.src = bust;
  }

  function setCatState(state){
    [catWait, catCrazy, catSad].forEach(el => { el.classList.add('hidden'); el.classList.remove('crazy','sad'); });
    if(state === 'wait'){
      catWait.classList.remove('hidden');
      restartGif(catWait);
    } else if(state === 'crazy'){
      catCrazy.classList.remove('hidden');
      restartGif(catCrazy);
    } else if(state === 'sad'){
      catSad.classList.remove('hidden');
      restartGif(catSad);
    }
  }

  // é±¼å¹²åŠ¨ç”»
  function spawnFish(){
    const fish = document.createElement('div');
    fish.className = 'fish';
    fish.textContent = 'ğŸŸ';
    const areaW = fishDropArea.clientWidth || 300;
    const left = Math.max(8, Math.min(areaW-36, (areaW/2 - 18) + randInt(-80,80)));
    fish.style.left = left + 'px';
    fishDropArea.appendChild(fish);
    setTimeout(()=> fish.remove(), 1000);
  }

  // å½©å¸¦åŠ¨ç”»
  function spawnConfetti(){
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    confetti.textContent = ['ğŸ‰', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'ğŸŠ'][randInt(0, 4)];
    const areaW = fishDropArea.clientWidth || 300;
    const left = Math.max(8, Math.min(areaW-36, (areaW/2 - 18) + randInt(-100,100)));
    confetti.style.left = left + 'px';
    confetti.style.animation = 'confettiFall 2s ease-out forwards';
    fishDropArea.appendChild(confetti);
    setTimeout(()=> confetti.remove(), 2000);
  }

  // æ£€æŸ¥å‡çº§ç³»ç»Ÿ
  function checkUpgrade(){
    // 10ä¸ªçŒ«æ¡æ¢1ä¸ªé±¼å¹²
    if(game.catSticks >= 10){
      game.catSticks -= 10;
      game.fish += 1;
      showUpgradeEffect('fish');
    }
    
    // 10ä¸ªé±¼å¹²æ¢1ä¸ªç½å¤´
    if(game.fish >= 10){
      game.fish -= 10;
      game.cans += 1;
      showUpgradeEffect('can');
    }
    
    // æ£€æŸ¥éšè—å¥–åŠ±è§£é”
    checkHiddenRewards();
  }
  
  // æ£€æŸ¥éšè—å¥–åŠ±è§£é”
  function checkHiddenRewards(){
    // æ³¡æ³¡æ•ˆæœï¼š5ä¸ªç½å¤´è§£é”
    if(game.cans >= 5 && !game.unlockedBubbles){
      game.unlockedBubbles = true;
      localStorage.setItem('ruba_unlockedBubbles', 'true');
      showUnlockNotification('ğŸ‰ è§£é”æ–°å¥–åŠ±ï¼šçŒ«å’ªæ´—æ¾¡æ³¡æ³¡æ•ˆæœï¼');
    }
    
    // å°è€é¼ ç©å…·ï¼š10ä¸ªç½å¤´è§£é”
    if(game.cans >= 10 && !game.unlockedMice){
      game.unlockedMice = true;
      localStorage.setItem('ruba_unlockedMice', 'true');
      showUnlockNotification('ğŸŠ è§£é”æ–°å¥–åŠ±ï¼šå°è€é¼ ç©å…·ï¼');
    }
    
    // æ’¸çŒ«æ•ˆæœï¼š15ä¸ªç½å¤´è§£é”
    if(game.cans >= 15 && !game.unlockedPetting){
      game.unlockedPetting = true;
      localStorage.setItem('ruba_unlockedPetting', 'true');
      showUnlockNotification('ğŸŒŸ è§£é”æ–°å¥–åŠ±ï¼šä¸»äººæ’¸çŒ«æ•ˆæœï¼');
    }
  }
  
  // æ˜¾ç¤ºè§£é”é€šçŸ¥
  function showUnlockNotification(message){
    const notification = document.createElement('div');
    notification.className = 'unlock-notification';
    notification.textContent = message;
    document.body.appendChild(notification);
    setTimeout(() => notification.remove(), 3000);
  }

  // æ˜¾ç¤ºå‡çº§æ•ˆæœ
  function showUpgradeEffect(type){
    const upgradeDiv = document.createElement('div');
    upgradeDiv.className = 'upgrade-effect';
    upgradeDiv.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
      color: white;
      padding: 20px 40px;
      border-radius: 20px;
      font-size: 24px;
      font-weight: bold;
      z-index: 1000;
      animation: upgradePulse 2s ease-out forwards;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    `;
    
    if(type === 'fish'){
      upgradeDiv.innerHTML = 'ğŸ‰ æ­å–œï¼10ä¸ªçŒ«æ¡æ¢1ä¸ªé±¼å¹²ï¼ğŸŸ';
    } else if(type === 'can'){
      upgradeDiv.innerHTML = 'ğŸŠ å¤ªæ£’äº†ï¼10ä¸ªé±¼å¹²æ¢1ä¸ªç½å¤´ï¼ğŸ¥«';
    }
    
    document.body.appendChild(upgradeDiv);
    setTimeout(()=> upgradeDiv.remove(), 2000);
  }

  // æ˜¾ç¤ºå¥–åŠ±æ•ˆæœ
  function showRewardEffect(type){
    const rewardDiv = document.createElement('div');
    rewardDiv.className = 'reward-effect';
    rewardDiv.style.cssText = `
      position: fixed;
      top: 20%;
      right: 20px;
      background: linear-gradient(45deg, #ff9a9e, #fecfef);
      color: #333;
      padding: 10px 20px;
      border-radius: 15px;
      font-size: 16px;
      font-weight: bold;
      z-index: 999;
      animation: rewardSlide 1.5s ease-out forwards;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    `;
    
    if(type === 'catStick'){
      rewardDiv.innerHTML = 'ğŸ¥– +1 çŒ«æ¡';
    }
    
    document.body.appendChild(rewardDiv);
    setTimeout(()=> rewardDiv.remove(), 1500);
  }

  // æ›´æ–°å¥–åŠ±æ˜¾ç¤º
  function updateRewardDisplay(){
    // æ›´æ–°å³ä¸Šè§’æ˜¾ç¤º
    document.getElementById('catSticks').textContent = game.catSticks;
    document.getElementById('fish').textContent = game.fish;
    document.getElementById('cans').textContent = game.cans;
    
    // æ›´æ–°å³ä¾§å¥–åŠ±åŒºåŸŸæ˜¾ç¤º
    const rewardDisplay = document.getElementById('rewardDisplay');
    if(rewardDisplay){
      rewardDisplay.innerHTML = `
        <div style="display: flex; gap: 15px; align-items: center; font-size: 14px;">
          <span>ğŸ¥– ${game.catSticks}</span>
          <span>ğŸŸ ${game.fish}</span>
          <span>ğŸ¥« ${game.cans}</span>
        </div>
      `;
    }
  }

  // åº”ç”¨å…³å¡é…è‰²
  function applyLevelColors(){
    const level = Math.min(game.level, 10); // æœ€å¤š10ç§é…è‰²
    document.body.className = `level-${level}`;
  }
  
  // éšè—å¥–åŠ±æ•ˆæœå®ç°
  
  // åˆ›å»ºåŠ¨æ€æç¤ºæ–‡å­—
  function createSpeechBubble(text, type, x, y) {
    const catArea = document.getElementById('catArea');
    const speech = document.createElement('div');
    speech.className = `effect-speech ${type}-speech`;
    speech.textContent = text;
    speech.style.left = x + 'px';
    speech.style.top = y + 'px';
    speech.style.transform = 'translate(-50%, -50%)';
    catArea.appendChild(speech);
    
    setTimeout(() => speech.remove(), 5000);
  }
  
  // æ³¡æ³¡æ•ˆæœ
  function createBubbles(){
    if(!game.unlockedBubbles) return;
    
    const catArea = document.getElementById('catArea');
    const bubbleCount = 8; // å¢åŠ æ³¡æ³¡æ•°é‡
    
    // æ˜¾ç¤ºæç¤ºæ–‡å­—
    const centerX = catArea.clientWidth / 2;
    const centerY = catArea.clientHeight / 2;
    createSpeechBubble('æˆ‘çˆ±æ³¡æ³¡ï¼Œå–œæ¬¢æ´—æ¾¡', 'bubble', centerX, centerY - 60);
    
    for(let i = 0; i < bubbleCount; i++){
      setTimeout(() => {
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        // é›†ä¸­åœ¨ä¸­å¤®åŒºåŸŸï¼ŒçŒ«å’ªå›¾ç‰‡å‘¨å›´
        const offsetX = (Math.random() - 0.5) * 120; // ä¸­å¤®Â±60pxèŒƒå›´
        const offsetY = (Math.random() - 0.5) * 80; // ä¸­å¤®Â±40pxèŒƒå›´
        bubble.style.left = (centerX + offsetX) + 'px';
        bubble.style.top = (centerY + offsetY + 20) + 'px'; // ç¨å¾®åä¸‹ä¸€ç‚¹
        bubble.style.animationDelay = Math.random() * 2 + 's';
        // éšæœºå¤§å°å˜åŒ–
        const size = 30 + Math.random() * 20; // 30-50px
        bubble.style.width = size + 'px';
        bubble.style.height = size + 'px';
        catArea.appendChild(bubble);
        
        setTimeout(() => bubble.remove(), 5000);
      }, i * 200); // å‡å°‘é—´éš”æ—¶é—´ï¼Œè®©æ³¡æ³¡æ›´å¯†é›†
    }
  }
  
  // å°è€é¼ ç©å…·æ•ˆæœ
  function createMice(){
    if(!game.unlockedMice) return;
    
    const catArea = document.getElementById('catArea');
    const mouseCount = 5; // å¢åŠ å°è€é¼ æ•°é‡
    
    // æ˜¾ç¤ºæç¤ºæ–‡å­—
    const centerX = catArea.clientWidth / 2;
    const centerY = catArea.clientHeight / 2;
    createSpeechBubble('Jerry Jerry ä½ åˆ«è·‘', 'mouse', centerX, centerY - 60);
    
    for(let i = 0; i < mouseCount; i++){
      setTimeout(() => {
        const mouse = document.createElement('div');
        mouse.className = 'mouse-toy';
        mouse.textContent = 'ğŸ­';
        // é›†ä¸­åœ¨ä¸­å¤®åŒºåŸŸï¼ŒçŒ«å’ªå›¾ç‰‡å‘¨å›´
        const offsetX = (Math.random() - 0.5) * 140; // ä¸­å¤®Â±70pxèŒƒå›´
        const offsetY = (Math.random() - 0.5) * 100; // ä¸­å¤®Â±50pxèŒƒå›´
        mouse.style.left = (centerX + offsetX) + 'px';
        mouse.style.top = (centerY + offsetY) + 'px';
        mouse.style.animationDelay = Math.random() * 2 + 's';
        // éšæœºå¤§å°å˜åŒ–
        const size = 24 + Math.random() * 16; // 24-40px
        mouse.style.fontSize = size + 'px';
        catArea.appendChild(mouse);
        
        setTimeout(() => mouse.remove(), 5000);
      }, i * 500); // å‡å°‘é—´éš”æ—¶é—´
    }
  }
  
  // æ’¸çŒ«æ•ˆæœ
  function createPettingHand(){
    if(!game.unlockedPetting) return;
    
    const catArea = document.getElementById('catArea');
    const centerX = catArea.clientWidth / 2;
    const centerY = catArea.clientHeight / 2;
    
    // æ˜¾ç¤ºæç¤ºæ–‡å­—
    createSpeechBubble('ä¸»äºº å¥½èˆ’æœ æˆ‘è¦ç¡ç€äº†...', 'petting', centerX, centerY - 80);
    
    setTimeout(() => {
      const hand = document.createElement('div');
      hand.className = 'petting-hand';
      hand.textContent = 'âœ‹';
      // æ›´é ä¸­å¤®ï¼Œæ¨¡æ‹ŸæŠšæ‘¸çŒ«å’ªå¤´éƒ¨
      hand.style.left = (centerX + (Math.random() - 0.5) * 20) + 'px'; // ä¸­å¤®Â±10pxèŒƒå›´
      hand.style.top = (centerY - 20 + (Math.random() - 0.5) * 10) + 'px'; // ç¨å¾®åä¸Šï¼Œæ›´é ä¸­å¤®
      hand.style.transform = 'translate(-50%, -50%)';
      hand.style.zIndex = '10'; // ç¡®ä¿åœ¨æœ€ä¸Šå±‚
      hand.style.opacity = '0.8'; // ç¨å¾®é€æ˜
      catArea.appendChild(hand);
      
      setTimeout(() => hand.remove(), 5000);
    }, Math.random() * 1000);
  }
  
  // ä¿®å‰ªçŒ«æ¯›æ•ˆæœ
  function createScissors(){
    if(!game.unlockedScissors) return;
    
    const catArea = document.getElementById('catArea');
    const centerX = catArea.clientWidth / 2;
    const centerY = catArea.clientHeight / 2;
    
    // æ˜¾ç¤ºæç¤ºæ–‡å­—
    createSpeechBubble('æ¥ä¸ªæ–°å‘å‹ï¼Œcoolï¼', 'scissors', centerX, centerY - 60);
    
    // åˆ›å»ºå‰ªåˆ€
    const scissors = document.createElement('div');
    scissors.className = 'scissors';
    scissors.textContent = 'âœ‚ï¸';
    scissors.style.left = (centerX + (Math.random() - 0.5) * 30) + 'px';
    scissors.style.top = (centerY - 10 + (Math.random() - 0.5) * 20) + 'px';
    scissors.style.transform = 'translate(-50%, -50%)';
    scissors.style.zIndex = '12';
    catArea.appendChild(scissors);
    
    // åˆ›å»ºæ‰è½çš„çŒ«æ¯›
    for(let i = 0; i < 6; i++){
      setTimeout(() => {
        const hair = document.createElement('div');
        hair.className = 'cat-hair';
        hair.style.left = (centerX + (Math.random() - 0.5) * 60) + 'px';
        hair.style.top = (centerY + 20) + 'px';
        hair.style.animationDelay = Math.random() * 0.5 + 's';
        catArea.appendChild(hair);
        
        setTimeout(() => hair.remove(), 5000);
      }, i * 200);
    }
    
    setTimeout(() => scissors.remove(), 5000);
  }
  
  // ä¸»äººæŠ±æŠ±æ•ˆæœ
  function createHug(){
    if(!game.unlockedHug) return;
    
    const catArea = document.getElementById('catArea');
    const centerX = catArea.clientWidth / 2;
    const centerY = catArea.clientHeight / 2;
    
    // æ˜¾ç¤ºæç¤ºæ–‡å­—
    createSpeechBubble('ä¹–ä¹–å¦‚å®ï¼Œæ¥æŠ±æŠ±', 'hug', centerX, centerY - 60);
    
    // åˆ›å»ºåŒæ‰‹ç¯æŠ±æ•ˆæœ
    const leftHand = document.createElement('div');
    leftHand.className = 'hug-hands';
    leftHand.textContent = 'ğŸ¤—';
    leftHand.style.left = (centerX - 30) + 'px';
    leftHand.style.top = (centerY - 10) + 'px';
    leftHand.style.transform = 'translate(-50%, -50%)';
    leftHand.style.zIndex = '12';
    catArea.appendChild(leftHand);
    
    const rightHand = document.createElement('div');
    rightHand.className = 'hug-hands';
    rightHand.textContent = 'ğŸ¤—';
    rightHand.style.left = (centerX + 30) + 'px';
    rightHand.style.top = (centerY - 10) + 'px';
    rightHand.style.transform = 'translate(-50%, -50%)';
    rightHand.style.zIndex = '12';
    catArea.appendChild(rightHand);
    
    setTimeout(() => {
      leftHand.remove();
      rightHand.remove();
    }, 5000);
  }
  
  // éšæœºè§¦å‘éšè—å¥–åŠ±æ•ˆæœï¼ˆè¿‡å…³æ—¶è§¦å‘ï¼‰
  function triggerRandomRewardOnLevelUp(){
    // å¼ºåˆ¶è§£é”æ‰€æœ‰æ•ˆæœç”¨äºæµ‹è¯•
    game.unlockedBubbles = true;
    game.unlockedMice = true;
    game.unlockedPetting = true;
    game.unlockedScissors = true;
    game.unlockedHug = true;
    
    const effects = ['bubbles', 'mice', 'petting', 'scissors', 'hug'];
    const randomEffect = effects[Math.floor(Math.random() * effects.length)];
    
    switch(randomEffect){
      case 'bubbles':
        createBubbles();
        break;
      case 'mice':
        createMice();
        break;
      case 'petting':
        createPettingHand();
        break;
      case 'scissors':
        createScissors();
        break;
      case 'hug':
        createHug();
        break;
    }
  }
  
  // è½®æµè§¦å‘éšè—å¥–åŠ±æ•ˆæœï¼ˆæµ‹è¯•æ¨¡å¼ï¼‰
  function triggerRotatingReward(){
    // å¼ºåˆ¶è§£é”æ‰€æœ‰æ•ˆæœç”¨äºæµ‹è¯•
    game.unlockedBubbles = true;
    game.unlockedMice = true;
    game.unlockedPetting = true;
    game.unlockedScissors = true;
    game.unlockedHug = true;
    
    const effects = ['bubbles', 'mice', 'petting', 'scissors', 'hug'];
    const currentEffect = effects[rewardCounter % effects.length];
    
    switch(currentEffect){
      case 'bubbles':
        createBubbles();
        break;
      case 'mice':
        createMice();
        break;
      case 'petting':
        createPettingHand();
        break;
      case 'scissors':
        createScissors();
        break;
      case 'hug':
        createHug();
        break;
    }
    
    rewardCounter++;
  }
  
  // éšæœºè§¦å‘éšè—å¥–åŠ±æ•ˆæœï¼ˆåŸç‰ˆæœ¬ï¼‰
  function triggerRandomReward(){
    if(!game.unlockedBubbles && !game.unlockedMice && !game.unlockedPetting) return;
    
    const effects = [];
    if(game.unlockedBubbles) effects.push('bubbles');
    if(game.unlockedMice) effects.push('mice');
    if(game.unlockedPetting) effects.push('petting');
    
    if(effects.length > 0){
      const randomEffect = effects[Math.floor(Math.random() * effects.length)];
      
      switch(randomEffect){
        case 'bubbles':
          createBubbles();
          break;
        case 'mice':
          createMice();
          break;
        case 'petting':
          createPettingHand();
          break;
      }
    }
  }

  // å¢å¼ºè¿‡å…³åº†ç¥æ•ˆæœ
  function showLevelUpCelebration(got){
    // åˆ›å»ºåº†ç¥é®ç½©
    const celebrationOverlay = document.createElement('div');
    celebrationOverlay.className = 'celebration-overlay';
    celebrationOverlay.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
      background-size: 400% 400%;
      animation: gradientShift 3s ease infinite;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      font-family: 'PingFang SC', 'Microsoft Yahei', sans-serif;
    `;
    
    celebrationOverlay.innerHTML = `
      <div style="text-align: center; animation: celebrationBounce 1s ease-out;">
        <div style="font-size: 80px; margin-bottom: 20px; animation: celebrationSpin 2s ease-in-out;">ğŸ‰</div>
        <h1 style="font-size: 48px; margin: 0; text-shadow: 3px 3px 6px rgba(0,0,0,0.3);">å¤ªæ£’äº†ï¼</h1>
        <h2 style="font-size: 32px; margin: 10px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">ç¬¬${game.level}å…³é€šè¿‡ï¼</h2>
        <p style="font-size: 24px; margin: 20px 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">ç­”å¯¹äº† ${got} / ${perLevelCount} é¢˜</p>
        <div style="font-size: 20px; margin: 30px 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
          <p>ğŸ¥– çŒ«æ¡: ${game.catSticks} | ğŸŸ é±¼å¹²: ${game.fish} | ğŸ¥« ç½å¤´: ${game.cans}</p>
        </div>
        <div style="font-size: 18px; margin-top: 20px; opacity: 0.9;">
          <p>ç»§ç»­åŠ æ²¹ï¼Œè§£é”æ›´å¤šå¥–åŠ±ï¼</p>
        </div>
      </div>
    `;
    
    document.body.appendChild(celebrationOverlay);
    
    // 5ç§’åç§»é™¤åº†ç¥ç•Œé¢å¹¶åº”ç”¨æ–°é…è‰²
    setTimeout(()=> {
      celebrationOverlay.remove();
      applyLevelColors(); // åº”ç”¨æ–°å…³å¡é…è‰²
      
      // åº†ç¥é¡µé¢æ˜¾ç¤ºå®Œæ¯•åï¼Œè§¦å‘éšæœºéšè—å¥–åŠ±æ•ˆæœ
      setTimeout(() => {
        triggerRandomRewardOnLevelUp();
      }, 1000); // å»¶è¿Ÿ1ç§’åæ˜¾ç¤ºæ•ˆæœ
    }, 5000);
  }

  // ç­”é¢˜
  function handleAnswer(userVal){
    // åœæ­¢å€’è®¡æ—¶
    stopTimer();
    
    const correct = currentQ.answer;
    
    // æ£€æŸ¥æ˜¯å¦è¶…æ—¶
    if(userVal === -999) {
      setCatState('sad');
      setTimeout(()=> {
        alert(`æ—¶é—´åˆ°ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ ${correct} ï¼ˆæç¤ºï¼šå¯ä»¥æ‰“å¼€ç«–å¼è¯•è¯•çœ‹å“¦ï¼‰`);
      }, 200);
      game.qIndex += 1;
      localStorage.setItem('ruba_qIndex', game.qIndex);
      if(game.qIndex >= perLevelCount){
        setTimeout(()=> evaluateLevel(), 900);
      } else {
        setTimeout(()=> renderQuestion(), 800);
      }
      return;
    }
    
    if(Number(userVal) === correct){
      game.score += 1;
      game.correctInLevel += 1;
      
      // æ–°å¢ï¼šç­”å¯¹è·å¾—1ä¸ªçŒ«æ¡
      game.catSticks += 1;
      
      // æ£€æŸ¥å‡çº§
      checkUpgrade();
      
      if(scoreEl) scoreEl.textContent = game.score;
      correctThis.textContent = game.correctInLevel;
      updateRewardDisplay();
      
      localStorage.setItem('ruba_score', game.score);
      localStorage.setItem('ruba_catSticks', game.catSticks);
      localStorage.setItem('ruba_fish', game.fish);
      localStorage.setItem('ruba_cans', game.cans);
      
      setCatState('crazy');
      spawnFish();
      
      // æ˜¾ç¤ºè·å¾—çŒ«æ¡çš„æ•ˆæœ
      showRewardEffect('catStick');
      
      // éšè—å¥–åŠ±æ•ˆæœç°åœ¨åœ¨è¿‡å…³æ—¶è§¦å‘ï¼Œè¿™é‡Œä¸è§¦å‘
    } else {
      setCatState('sad');
      setTimeout(()=> {
        alert(`å“å‘€ï¼Œç­”é”™å•¦ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ ${correct} ï¼ˆæç¤ºï¼šå¯ä»¥æ‰“å¼€ç«–å¼è¯•è¯•çœ‹å“¦ï¼‰`);
      },200);
    }
    game.qIndex += 1;
    localStorage.setItem('ruba_qIndex', game.qIndex);
    localStorage.setItem('ruba_correct', game.correctInLevel);
    if(game.qIndex >= perLevelCount){
      setTimeout(()=> evaluateLevel(), 900);
    } else {
      setTimeout(()=> renderQuestion(), 800);
    }
  }

  // è¯„ä¼°å…³å¡
  function evaluateLevel(){
    const got = game.correctInLevel;
    if(got >= correctThreshold){
      // å¢å¼ºè¿‡å…³å¥–åŠ±æ•ˆæœ
      showLevelUpCelebration(got);
      
      game.level += 1;
      game.qIndex = 0;
      game.correctInLevel = 0;
      localStorage.setItem('ruba_level', game.level);
      localStorage.setItem('ruba_qIndex', game.qIndex);
      localStorage.setItem('ruba_correct', game.correctInLevel);
      levelLabel.textContent = game.level;
      levelNumber.textContent = game.level;
      
      // å¢å¼ºè¿‡å…³ç‰¹æ•ˆ
      for(let i=0;i<12;i++){ setTimeout(() => spawnFish(), 60*i); }
      for(let i=0;i<8;i++){ setTimeout(() => spawnConfetti(), 100*i); }
      
      setTimeout(()=> renderQuestion(), 2000);
    } else {
      alert(`æœ¬å…³ç­”å¯¹ ${got} / ${perLevelCount}ï¼ˆæœªè¾¾åˆ° ${correctThreshold}ï¼‰ã€‚å†æ¥ä¸€æ¬¡å§ï¼`);
      game.qIndex = 0;
      game.correctInLevel = 0;
      localStorage.setItem('ruba_qIndex', game.qIndex);
      localStorage.setItem('ruba_correct', game.correctInLevel);
      correctThis.textContent = game.correctInLevel;
      setTimeout(()=> renderQuestion(), 600);
    }
  }

  // å¡«ç©ºæäº¤
  submitFill.addEventListener('click', ()=>{
    const v = parseInt(answerInput.value,10);
    if(Number.isFinite(v)) handleAnswer(v);
    else alert('è¯·è¾“å…¥æ•°å­—ç­”æ¡ˆ');
  });
  answerInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ submitFill.click(); } });

  // åˆ‡æ¢æ¨¡å¼
  modeToggle.addEventListener('click', ()=>{
    if(mode === 'choose'){ mode = 'fill'; modeToggle.textContent = 'åˆ‡æ¢åˆ° é€‰æ‹©é¢˜æ¨¡å¼'; }
    else { mode = 'choose'; modeToggle.textContent = 'åˆ‡æ¢åˆ° å¡«ç©ºé¢˜æ¨¡å¼'; }
    renderQuestion();
  });

  // ç«–å¼æ˜¾ç¤ºé€»è¾‘
  let isVertShown = true;
  showVertBtn.addEventListener('click', ()=>{
    isVertShown = !isVertShown;
    showVertBtn.textContent = isVertShown ? 'éšè—ç«–å¼' : 'æ˜¾ç¤ºç«–å¼';
    if(isVertShown && currentQ) renderVertical(currentQ);
    else verticalArea.textContent = 'å·²éšè—ç«–å¼';
  });

  // ç«–å¼æ ¼å¼åŒ–ï¼ˆä¸æ˜¾ç¤ºç»“æœï¼‰
  function renderVertical(q){
    const a = q.num1.toString();
    const b = q.num2.toString();
    const maxlen = Math.max(a.length, b.length) + 1;
    const pad = (s, len) => s.padStart(len, ' ');
    const line1 = pad(a, maxlen);
    const line2 = q.operator + pad(b, maxlen - 1);
    const hr = '-'.repeat(maxlen);
    const empty = ' '.repeat(maxlen);
    verticalArea.textContent = `${line1}\n${line2}\n${hr}\n${empty}`;
  }

  // é‡ç½®
  resetBtn.addEventListener('click', ()=>{
    if(confirm('ç¡®è®¤é‡ç½®å…³å¡ä¸æ‰€æœ‰å¥–åŠ±å—ï¼Ÿ')) {
      game = { level:1, score:0, qIndex:0, correctInLevel:0, catSticks:0, fish:0, cans:0, unlockedBubbles:false, unlockedMice:false, unlockedPetting:false, unlockedScissors:false, unlockedHug:false };
      rewardCounter = 0;
      localStorage.setItem('ruba_level', '1');
      localStorage.setItem('ruba_score', '0');
      localStorage.setItem('ruba_qIndex', '0');
      localStorage.setItem('ruba_correct', '0');
      localStorage.setItem('ruba_catSticks', '0');
      localStorage.setItem('ruba_fish', '0');
      localStorage.setItem('ruba_cans', '0');
      localStorage.setItem('ruba_unlockedBubbles', 'false');
      localStorage.setItem('ruba_unlockedMice', 'false');
      localStorage.setItem('ruba_unlockedPetting', 'false');
      levelLabel.textContent = '1';
      levelNumber.textContent = '1';
      if(scoreEl) scoreEl.textContent = '0';
      qIdx.textContent = '0';
      qNumber.textContent = '1';
      correctThis.textContent = '0';
      updateRewardDisplay();
      renderQuestion();
    }
  });

  // ç®¡ç†å‘˜é¢æ¿åŠŸèƒ½
  const adminKeyBtn = document.getElementById('adminKeyBtn');
  const adminTrigger = document.getElementById('adminTrigger');
  const adminPanel = document.getElementById('adminPanel');
  const maxValueInput = document.getElementById('maxValue');
  const timerValueInput = document.getElementById('timerValue');
  const saveSettingsBtn = document.getElementById('saveSettings');
  const closeAdminBtn = document.getElementById('closeAdmin');
  
  // å¯†ç éªŒè¯
  let passwordAttempts = 0;
  const maxAttempts = 3;
  
  // é’¥åŒ™æŒ‰é’®ç‚¹å‡»äº‹ä»¶
  adminKeyBtn.addEventListener('click', () => {
    const password = prompt('è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼š');
    if(password === '5200') {
      adminPanel.style.display = 'block';
      maxValueInput.value = gameSettings.maxValue;
      timerValueInput.value = gameSettings.timerValue;
      passwordAttempts = 0;
    } else {
      passwordAttempts++;
      if(passwordAttempts >= maxAttempts) {
        alert('å¯†ç é”™è¯¯æ¬¡æ•°è¿‡å¤šï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•ï¼');
        adminKeyBtn.style.display = 'none';
      } else {
        alert(`å¯†ç é”™è¯¯ï¼è¿˜æœ‰ ${maxAttempts - passwordAttempts} æ¬¡æœºä¼š`);
      }
    }
  });
  
  // å¤‡ç”¨éšè—æŒ‰é’®ï¼ˆä¿ç•™åŠŸèƒ½ï¼‰
  adminTrigger.addEventListener('click', () => {
    const password = prompt('è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼š');
    if(password === '5200') {
      adminPanel.style.display = 'block';
      maxValueInput.value = gameSettings.maxValue;
      timerValueInput.value = gameSettings.timerValue;
      passwordAttempts = 0;
    } else {
      passwordAttempts++;
      if(passwordAttempts >= maxAttempts) {
        alert('å¯†ç é”™è¯¯æ¬¡æ•°è¿‡å¤šï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•ï¼');
        adminTrigger.style.display = 'none';
      } else {
        alert(`å¯†ç é”™è¯¯ï¼è¿˜æœ‰ ${maxAttempts - passwordAttempts} æ¬¡æœºä¼š`);
      }
    }
  });
  
  saveSettingsBtn.addEventListener('click', () => {
    const newMaxValue = parseInt(maxValueInput.value, 10);
    const newTimerValue = parseInt(timerValueInput.value, 10);
    
    if(newMaxValue < 50 || newMaxValue > 1000) {
      alert('æœ€å¤§æ•°å€¼å¿…é¡»åœ¨50-1000ä¹‹é—´ï¼');
      return;
    }
    
    if(newTimerValue < 5 || newTimerValue > 60) {
      alert('ç­”é¢˜è®¡æ—¶å¿…é¡»åœ¨5-60ç§’ä¹‹é—´ï¼');
      return;
    }
    
    gameSettings.maxValue = newMaxValue;
    gameSettings.timerValue = newTimerValue;
    
    localStorage.setItem('ruba_maxValue', newMaxValue);
    localStorage.setItem('ruba_timerValue', newTimerValue);
    
    alert('è®¾ç½®å·²ä¿å­˜ï¼');
    adminPanel.style.display = 'none';
  });
  
  closeAdminBtn.addEventListener('click', () => {
    adminPanel.style.display = 'none';
  });
  
  // ç‚¹å‡»é¢æ¿å¤–éƒ¨å…³é—­
  adminPanel.addEventListener('click', (e) => {
    if(e.target === adminPanel) {
      adminPanel.style.display = 'none';
    }
  });

  // init first question
  renderQuestion();
})();
</script>
</body>

</html>
